{"is_source_file": true, "format": "JavaScript", "description": "This file provides utility functions for safe access and management of localStorage, including availability checks, safe get/set operations with JSON parsing, backup of corrupted data, and a stub for data migration handling. The functions facilitate versioned data handling and ensure robustness against environment restrictions like SSR or privacy mode.", "external_files": [], "external_methods": [], "published": ["STORAGE_KEY", "isStorageAvailable", "getItemSafe", "setItemSafe", "backupAndReset", "migrateIfNeeded"], "classes": [], "methods": [{"name": "isStorageAvailable()", "description": "Checks if localStorage is available and functional, using try/catch blocks to handle restricted environments.", "scope": "", "scopeKind": ""}, {"name": "getItemSafe(key, defaultValue = null)", "description": "Safely retrieves a JSON value from localStorage, returning a default if unavailable or parsing fails.", "scope": "", "scopeKind": ""}, {"name": "setItemSafe(key, value)", "description": "Safely serializes and stores a value in localStorage, returning success status.", "scope": "", "scopeKind": ""}, {"name": "backupAndReset(key, badValue)", "description": "Backs up a corrupt or incompatible value under a timestamped backup key and resets the main key.", "scope": "", "scopeKind": ""}, {"name": "migrateIfNeeded(payload)", "description": "Handles schema migrations with version checks, currently a no-op for version 1, with structure for future migrations.", "scope": "", "scopeKind": ""}], "calls": ["window.localStorage.setItem", "window.localStorage.removeItem", "JSON.parse", "JSON.stringify", "console.warn", "new Date().toISOString()"], "search-terms": ["localStorage safety", "versioned storage migration", "backup corrupted storage", "localStorage availability check", "JSON parse fallback"], "state": 2, "file_id": 13, "knowledge_revision": 30, "git_revision": "09db157777a9def5cadb9e92ba30874acf7ce484", "ctags": [{"_type": "tag", "name": "STORAGE_KEY", "path": "/home/kavia/workspace/code-generation/local-notes-manager-185853-185873/frontend_react/src/utils/storage.js", "pattern": "/^export const STORAGE_KEY = \"notes.app.v1\";$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "backupAndReset", "path": "/home/kavia/workspace/code-generation/local-notes-manager-185853-185873/frontend_react/src/utils/storage.js", "pattern": "/^export function backupAndReset(key, badValue) {$/", "language": "JavaScript", "kind": "function", "signature": "(key, badValue)"}, {"_type": "tag", "name": "getItemSafe", "path": "/home/kavia/workspace/code-generation/local-notes-manager-185853-185873/frontend_react/src/utils/storage.js", "pattern": "/^export function getItemSafe(key, defaultValue = null) {$/", "language": "JavaScript", "kind": "function", "signature": "(key, defaultValue = null)"}, {"_type": "tag", "name": "isStorageAvailable", "path": "/home/kavia/workspace/code-generation/local-notes-manager-185853-185873/frontend_react/src/utils/storage.js", "pattern": "/^export function isStorageAvailable() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "migrateIfNeeded", "path": "/home/kavia/workspace/code-generation/local-notes-manager-185853-185873/frontend_react/src/utils/storage.js", "pattern": "/^export function migrateIfNeeded(payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(payload)"}, {"_type": "tag", "name": "notes", "path": "/home/kavia/workspace/code-generation/local-notes-manager-185853-185873/frontend_react/src/utils/storage.js", "pattern": "/^      notes: Array.isArray(payload.notes) ? payload.notes : [],$/", "language": "JavaScript", "kind": "property", "scope": "migrateIfNeeded.working", "scopeKind": "class"}, {"_type": "tag", "name": "setItemSafe", "path": "/home/kavia/workspace/code-generation/local-notes-manager-185853-185873/frontend_react/src/utils/storage.js", "pattern": "/^export function setItemSafe(key, value) {$/", "language": "JavaScript", "kind": "function", "signature": "(key, value)"}, {"_type": "tag", "name": "settings", "path": "/home/kavia/workspace/code-generation/local-notes-manager-185853-185873/frontend_react/src/utils/storage.js", "pattern": "/^      settings: typeof payload.settings === \"object\" && payload.settings !== null ? payload.sett/", "language": "JavaScript", "kind": "property", "scope": "migrateIfNeeded.working", "scopeKind": "class"}, {"_type": "tag", "name": "version", "path": "/home/kavia/workspace/code-generation/local-notes-manager-185853-185873/frontend_react/src/utils/storage.js", "pattern": "/^      version: typeof payload.version === \"number\" ? payload.version : 1,$/", "language": "JavaScript", "kind": "property", "scope": "migrateIfNeeded.working", "scopeKind": "class"}, {"_type": "tag", "name": "working", "path": "/home/kavia/workspace/code-generation/local-notes-manager-185853-185873/frontend_react/src/utils/storage.js", "pattern": "/^    let working = {$/", "language": "JavaScript", "kind": "class", "scope": "migrateIfNeeded", "scopeKind": "class"}], "hash": "f4c4c7bc059d1a637a4d98b291be9fa3", "format-version": 4, "code-base-name": "frontend_react", "filename": "frontend_react/src/utils/storage.js", "fields": [{"name": "notes: Array.isArray(payload.notes) ? payload.notes : [],", "scope": "migrateIfNeeded.working", "scopeKind": "class", "description": "unavailable"}, {"name": "settings: typeof payload.settings === \"object\" && payload.settings !== null ? payload.sett/", "scope": "migrateIfNeeded.working", "scopeKind": "class", "description": "unavailable"}, {"name": "version: typeof payload.version === \"number\" ? payload.version : 1,", "scope": "migrateIfNeeded.working", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"30": "09db157777a9def5cadb9e92ba30874acf7ce484"}]}